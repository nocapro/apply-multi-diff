# Tests for edge cases
apply_diff_tests:
  - name: pure-insertion-at-start
    description: Should correctly insert content at the beginning of a file
    input:
      original_content: |
        line 1
        line 2
      diff_content: |
        --- a/file.txt
        +++ b/file.txt
        @@ -0,0 +1,2 @@
        +new line 1
        +new line 2
    expected:
      success: true
      content: |
        new line 1
        new line 2
        line 1
        line 2

  - name: unicode-characters
    description: Should correctly handle files with unicode characters
    input:
      original_content: "你好世界"
      diff_content: |
        --- a/file.txt
        +++ b/file.txt
        @@ -1 +1 @@
        -你好世界
        +こんにちは世界
    expected:
      success: true
      content: "こんにちは世界"

  - name: pure-insertion-after-line
    description: Should correctly apply a hunk that only contains additions after a specific line
    input:
      original_content: |
        line 1
        line 3
      diff_content: |
        --- a/file.txt
        +++ b/file.txt
        @@ -1,0 +2,1 @@
        +line 2
    expected:
      success: true
      content: |
        line 1
        line 2
        line 3

  - name: pure-deletion-hunk
    description: Should correctly apply a hunk that only contains deletions
    input:
      original_content: |
        line 1
        line 2 to delete
        line 3
      diff_content: |
        --- a/file.txt
        +++ b/file.txt
        @@ -1,3 +1,2 @@
         line 1
        -line 2 to delete
         line 3
    expected:
      success: true
      content: |
        line 1
        line 3

  - name: apply-to-empty-file
    description: Should correctly apply a diff to an empty file (file creation)
    input:
      original_content: ""
      diff_content: |
        --- /dev/null
        +++ b/file.txt
        @@ -0,0 +1,3 @@
        +Hello
        +World
        +!
    expected:
      success: true
      content: |
        Hello
        World
        !

  - name: delete-all-content
    description: Should correctly empty a file when the diff removes all lines
    input:
      original_content: |
        line 1
        line 2
      diff_content: |
        --- a/file.txt
        +++ b/file.txt
        @@ -1,2 +0,0 @@
        -line 1
        -line 2
    expected:
      success: true
      content: ""

  - name: modify-start-of-file
    description: Should correctly apply a hunk that modifies the beginning of the file
    input:
      original_content: |
        first line
        second line
      diff_content: |
        --- a/file.txt
        +++ b/file.txt
        @@ -1,2 +1,2 @@
        -first line
        +modified first line
         second line
    expected:
      success: true
      content: |
        modified first line
        second line

  - name: add-to-file-without-trailing-newline
    description: Should correctly add content to a file that lacks a trailing newline
    input:
      original_content: "line 1"
      diff_content: |
        --- a/file.txt
        +++ b/file.txt
        @@ -1 +1,2 @@
         line 1
        +line 2
    expected:
      success: true
      content: |
        line 1
        line 2