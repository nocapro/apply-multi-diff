uuid: 421683be-46cd-4d87-a2f0-f9644d6b7979
projectId: diff-apply
createdAt: '2025-09-03T02:29:28.397Z'
linesAdded: 5
linesRemoved: 5
gitCommitMsg: 'fix: align package.json exports with tsup build output'
promptSummary: Fixing a build warning related to package.json exports.
reasoning:
  - >-
    ok, got it. the `tsup` build warning is a classic `package.json` exports map
    issue. with `"type": "module"`, your build artifacts are `index.js` (esm)
    and `index.cjs` (cjs). your `package.json` points to the wrong files and has
    the `types` condition in the wrong order.
  - i'll fix `package.json` to align with the build output and best practices.
  - >-
    This patch corrects the `main`, `module`, and `exports` fields to point to
    the correct build artifacts generated by `tsup` and resolves the warning by
    reordering the `exports` conditions. should build clean now.
operations:
  - type: write
    path: package.json
    content: |-
      --- package.json
      +++ package.json
      @@ -2,15 +2,15 @@
         "name": "apply-multi-diff",
         "version": "0.1.0",
         "description": "A zero-dependency library to apply unified diffs and search-and-replace patches, with support for fuzzy matching.",
         "type": "module",
      -  "main": "./dist/index.js",
      -  "module": "./dist/index.mjs",
      +  "main": "./dist/index.cjs",
      +  "module": "./dist/index.js",
         "types": "./dist/index.d.ts",
         "exports": {
           ".": {
      -      "import": "./dist/index.mjs",
      -      "require": "./dist/index.js",
      -      "types": "./dist/index.d.ts"
      +      "types": "./dist/index.d.ts",
      +      "import": "./dist/index.js",
      +      "require": "./dist/index.cjs"
           }
         },
         "files": [
    patchStrategy: new-unified
snapshot:
  package.json: |-
    {
      "name": "apply-multi-diff",
      "version": "0.1.0",
      "description": "A zero-dependency library to apply unified diffs and search-and-replace patches, with support for fuzzy matching.",
      "type": "module",
      "main": "./dist/index.js",
      "module": "./dist/index.mjs",
      "types": "./dist/index.d.ts",
      "exports": {
        ".": {
          "import": "./dist/index.mjs",
          "require": "./dist/index.js",
          "types": "./dist/index.d.ts"
        }
      },
      "files": [
        "dist"
      ],
      "scripts": {
        "build": "tsup",
        "test": "bun test"
      },
      "repository": {
        "type": "git",
        "url": "git+https://github.com/nocapro/apply-multi-diff.git"
      },
      "keywords": [
        "diff",
        "patch",
        "apply",
        "unified-diff",
        "search-replace",
        "fuzzy"
      ],
      "license": "MIT",
      "bugs": {
        "url": "https://github.com/nocapro/apply-multi-diff/issues"
      },
      "homepage": "https://github.com/nocapro/apply-multi-diff#readme",
      "devDependencies": {
        "@types/js-yaml": "^4.0.9",
        "bun-types": "latest",
        "js-yaml": "^4.1.0",
        "tsup": "^8.0.2"
      },
      "peerDependencies": {
        "typescript": "^5.0.0"
      }
    }
approved: true
